# 区块链系统的扩容需求

> 出现的原因/驱动

区块链的生态不足以承载当前庞大且不断增长的交易量和用户需求.针对这种问题的解决方式是对区块链系统进行扩容.尤指`以太坊`.

以太坊的性能,目前的`TPS`在`10 ~ 30`之间,交易性能满足不了需求,交易池不断堆积臃肿,用户为了尽快的完成交易,推高了`Gas`费用.极大地阻碍了用户使用和降低了用户体验.

> 扩容方式

严格意义上说,扩容方式有`4`种

* L1竞争链
* 链上扩容(对链本身进行性能升级)
* 侧链(side chain)
* Layer2

四种方式都旨在解决用户的需求问题,`提升性能`,`降低使用成本`,`功能多样化`

**L1**

比如:

* BSC(Binance Smart Chain)
* Avalanche
* Solana
* Tron(波场)

L1分两类,一是兼容EVM的网络,二是不兼容的网络.发布兼容EVM的L1可以方便以太坊的开发人员直接将以太坊上部署的原有项目,通过复制粘贴部署到新的L1上.

以上4种L1,只有`Solana`是不兼容的

**链上扩容**

以`以太坊`为例,以太坊的计划是在将来升级到`10W TPS`,当前已完成的升级:

1. Merge
   从Pow向Pos转型,摆脱资源浪费
2. Surge(现阶段,还未完成)
   利用`分片技术`提高网络`TPS`,降低`Gas`,分片会将以太坊分成若干更小的链，整个网络的 TPS 将是所有小区块链 TPS 的总和（就像在高速路上增加更多车道可以容纳更多车辆），这将显着提高网络的可扩展性,以太坊预计将会创建 64 个分片。
   POS 是分片的基础：因为分片分割了整条链上的资源，如果是采用 POW 共识，此时每条分片链上的算力将会是原来的 1/n，这样针对分片链的攻击将容易很多，安全性得不到保障！而 POS 不需要算力，每个分片链上的验证者都是由共识随机分配的，同时作恶节点将会被惩罚削减质押的 ETH，所以 POS 也就不会因为分片而出现安全性下降的问题。

后续优化还有节点的存储结构.

**侧链**

> 侧链的安全性取决侧链本身的机制

侧链与L1中兼容链的差别有点模糊,侧链也有自己的原生币,比如`polygon`的`Matic`,不同之处是它们可用于专门处理以太坊过剩的交易量(有可定制化的特性),可以与以太坊生态共生促进,不完全是与以太坊竞争.侧链能够起到对主链扩容和辅助作用,但是当主链不复存在时,侧链依然可以作为一个独立链进行运作.

**侧链是如何工作的？**

为了支持处理链之间的交易，**侧链与它们所连接的主链保持双向挂钩。**

这允许用户将以太坊从主网发送到诸如 Polygon 这样的侧链。但是，转移从未真正发生过。双向挂钩只是将转移的金额锁定在主网上，并在侧链上铸造出资产的镜像版本。这是通过智能合约在主链上燃烧代币并在侧链上铸造代币来实现的。这就是为什么发送到 Polygon 的以太坊可以作为 wETH （ Wrapped Ethereum）来使用。

我的理解:侧链归根结底是一条独立于主链的区块链系统(有它自己的原生币,使用不同的共识协议等差异),侧链和主链的交互用一种桥接合约的交互协议实现将用户的需求移交给侧链来执行完成.本质上是一种逻辑的价值转移,因为用户在主链上的资产并未消失而是被锁定无法使用.当用户在侧链上的需求完成,可以将资产从侧链转移回主链,解锁被锁定的原有资产.



**Layer2**

> Layer2没有原生币
>
> 安全性继承于主链

Layer2目前的主流解决方案是:**rollups**

**rollups 是如何工作的？**

rollups从主链上拉取交易在链下完成执行验证,验证结束后再将交易结果打包发回主链,主链只需要进行状态的记录修改,省去了执行交易逻辑所需的资源.大大提高了TPS

如果我们将区块链上的每个交易视为一条简单的数据，如果您能够在单个数据中包含 50 个交易会怎样？这正是汇总的工作方式。由于他们能够在将多个事务发送回处理之前合并为一个，这意味着rollups 将继续沿基础层提高效率。因此，基础层的效率越高，roll-up 的效率就越高。

**rollups**有两种方式:

1.`Zero-knowledge Rollups` 基于零知识证明

2.`Optimistic Rollups`	乐观的认为所有的交易都是有效的,无恶意的,但是交易存在一个`挑战期`,交易提交后,在挑战期内任何人都可以对交易进行欺诈证明,验证提交的交易是否正确.

`Optimism 和 Arbitrum` 是在`Optimistic Rollups`方面,目前市值最大的两个L2























